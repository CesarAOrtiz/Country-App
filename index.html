<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta
            name="description"
            content="A website to display important information about all the countries of the world"
        />
        <link rel="icon" href="favicon/favicon.png" type="image/png" />
        <link rel="stylesheet" href="css/index.css" />
        <title>Country App</title>
    </head>
    <body>
        <header>
            <p id="logo">Countries</p>
            <p id="dark" onclick="cambiarModo()">Dark Mode</p>
        </header>
        <form>
            <input type="text" placeholder="Search" aria-label="Search field" />
            <img src="icons/lupa.png" width="20" height="20" alt="Search" />
        </form>
        <section>
            <div>
                <div>
                    <div></div>
                    <ul>
                        <li>Country</li>
                        <li>Population:</li>
                        <li>Capital:</li>
                        <li>Region:</li>
                    </ul>
                </div>
            </div>
        </section>
        <script>
            window.onload = callAPI;
            window.onresize = gridLayout;

            async function callAPI() {
                try {
                    const response = await fetch(
                        "https://restcountries.eu/rest/v2/all?fields=name;capital;flag;region;population"
                    );
                    const data = await response.json();
                    gridLayout();
                    await show(data);
                } catch (error) {
                    console.log(error);
                }
            }

            async function show(object) {
                html = "";
                object.forEach((element) => {
                    html += `
                <div>
                    <div><img src="${element.flag}" alt="Flag"></div>
                    <ul>
                        <li>${element.name}</li>
                        <li>Capital: ${element.capital}</li>
                        <li>Region: ${element.region}</li>
                        <li>Poblacion: ${element.population}</li>
                    </ul>
                </div>`;
                });
                document.querySelector("section div").innerHTML = html;
            }

            function gridLayout() {
                let sec = document.querySelector("section");
                let grid = document.querySelector("section div");
                let cell = document.querySelector("section div div");
                let cellMargin = parseInt(window.getComputedStyle(cell).margin);
                let num = parseInt(
                    sec.clientWidth / (cell.offsetWidth + cellMargin)
                );
                grid.style.gridTemplateColumns = `repeat(${num}, 1fr)`;
            }

            function cambiarModo() {
                document.body.classList.toggle("dark");
                document.querySelector("form").classList.toggle("dark-element");
                document
                    .querySelector("header")
                    .classList.toggle("dark-element");
                document
                    .querySelectorAll("section div div ul")
                    .forEach((obj) => {
                        obj.classList.toggle("dark-element");
                    });
            }
        </script>
        <script src="js/index.js"></script>
    </body>
</html>
